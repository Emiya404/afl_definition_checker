--- a/afl-fuzz.c        2025-12-23 15:36:49.349971940 +0800
+++ b/afl-fuzz.c        2025-12-23 15:41:12.394020810 +0800
@@ -676,6 +676,7 @@
   return result;
 }
 
+EXP_ST int score_log_fd = 0x0;
 /* Select a seed to exercise the target state */
 struct queue_entry *choose_seed(u32 target_state_id, u8 mode)
 {
@@ -751,7 +752,12 @@
   } else {
     PFATAL("AFLNet - the states hashtable has no entries for state %d", target_state_id);
   }
-
+  u8 choose_buf[0x100];
+  memset(choose_buf, 0x0, 0x100);
+  sprintf(choose_buf, "state %u, choose %s\n", target_state_id, result->fname);
+  if(score_log_fd > 0){
+    write(score_log_fd, choose_buf, strlen(choose_buf));
+  }
   return result;
 }
 
@@ -4778,6 +4784,27 @@
 /* A spiffy retro stats screen! This is called every stats_update_freq
    execve() calls, plus in several other circumstances. */
 
+EXP_ST int score_log_time = 0x0;
+#define SCORE_LOG_FREQ 0x8
+
+static void setup_score_log(void){
+  u8 name_buf[0x100];
+  memset(name_buf, 0x0, 0x100);
+  sprintf(name_buf, "%s/score_log.txt", out_dir);
+  score_log_fd = open(name_buf, O_CREAT | O_RDWR, 0666);
+  if(score_log_fd < 0){
+    PFATAL("score log file create fail");
+  }
+  return;
+}
+
+static void destroy_score_log(void){
+  if(score_log_fd > 0){
+    close(score_log_fd);
+  }
+  return;
+}
+
 static void show_stats(void) {
 
   static u64 last_stats_ms, last_plot_ms, last_ms, last_execs;
@@ -5257,8 +5284,18 @@
         state = kh_val(khms_states, k);
         SAYF(cRST "S%-3s:%-4s,"cCYA "%-5s,"cLRD "%-5s,"cGRA "%-5s",  DI(state->id), DI(state->selected_times), DI(state->fuzzs), DI(state->paths_discovered), DI(state->paths));
         if ((i + 1) % 3 == 0) SAYF("\n");
+        if(!((score_log_time) % (SCORE_LOG_FREQ))){
+          u32 score = ceil(1000 * pow(2, -log10(log10(state->fuzzs + 1) * state->selected_times + 1)) * pow(2, log(state->paths_discovered + 1)));
+          u8 score_buf[0x100];
+          memset(score_buf, 0x0, 0x100);
+          sprintf(score_buf, "%u|%u|%u|%u|%u\n", state_id, state->selected_times, state->fuzzs, state->paths_discovered, score);
+          if(score_log_fd > 0){
+            write(score_log_fd, score_buf, strlen(score_buf));
+          }
+        }
       }
     }
+    score_log_time++;
   }
 
   /* Hallelujah! */
@@ -9130,7 +9167,7 @@
   detect_file_args(argv + optind + 1);
 
   if (!out_file) setup_stdio_file();
-
+  setup_score_log();
   check_binary(argv[optind]);
 
   start_time = get_cur_time();
@@ -9321,7 +9358,7 @@
   ck_free(sync_id);
 
   destroy_ipsm();
-
+  destroy_score_log();
   alloc_report();
 
   OKF("We're done here. Have a nice day!\n");